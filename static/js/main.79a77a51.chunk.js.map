{"version":3,"sources":["components/TextEditor.js","App.js","index.js"],"names":["TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","TOOLBAR_OPTIONS","header","font","list","color","background","script","align","useEffect","s","io","disconnect","textChangeHandler","delta","oldDelta","source","emit","on","off","updateContents","once","document","setContents","enable","interval","setInterval","getContents","clearInterval","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","basename","process","path","exact","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"+NAMe,SAASA,IACpB,IAAYC,EAAeC,cAAnBC,GACR,EAA4BC,qBAA5B,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAA0BF,qBAA1B,mBAAOG,EAAP,KAAcC,EAAd,KAEMC,EAAkB,CACpB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAELC,qBAAU,WACN,IAAMC,EAAIC,aAAG,yBAEb,OADAb,EAAUY,GACH,WACHA,EAAEE,gBAEP,IAEHH,qBAAU,WAEN,GAAc,MAAVZ,GAA2B,MAATE,EAAtB,CAEA,IAAMc,EAAoB,SAACC,EAAOC,EAAUC,GACzB,SAAXA,GACJnB,EAAOoB,KAAK,eAAgBH,IAKhC,OAFAf,EAAMmB,GAAG,cAAeL,GAEjB,WACHd,EAAMoB,IAAI,cAAeN,OAE9B,CAAChB,EAAQE,IAGZU,qBAAU,WAEN,GAAc,MAAVZ,GAA2B,MAATE,EAAtB,CAEA,IAAMc,EAAoB,SAACC,GACvBf,EAAMqB,eAAeN,IAKzB,OAFAjB,EAAOqB,GAAG,kBAAmBL,GAEtB,WACHhB,EAAOsB,IAAI,kBAAmBN,OAEnC,CAAChB,EAAQE,IAEZU,qBAAU,WACQ,MAAVZ,GAA2B,MAATE,IAEtBF,EAAOwB,KAAK,iBAAiB,SAAAC,GACzBvB,EAAMwB,YAAYD,GAClBvB,EAAMyB,YAGV3B,EAAOoB,KAAK,eAAgBxB,MAC7B,CAACI,EAAQE,EAAON,IAEnBgB,qBAAU,WACN,GAAc,MAAVZ,GAA2B,MAATE,EAAtB,CAEA,IAAM0B,EAAWC,aAAY,WACzB7B,EAAOoB,KAAK,gBAAiBlB,EAAM4B,iBAnElB,KAsErB,OAAO,WACHC,cAAcH,OAGnB,CAAC5B,EAAQE,EAAON,IAInB,IAAMoC,EAAaC,uBACf,SAACC,GACG,GAAe,MAAXA,EAAJ,CACAA,EAAQC,UAAY,GACpB,IAAMC,EAASX,SAASY,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CACxBK,MAAO,OACPC,QAAS,CACLC,QAASvC,KAGjBmC,EAAEK,UACFL,EAAEM,QAAQ,cACV1C,EAASoC,MAEb,IAEJ,OACI,qBAAKO,UAAU,YAAYC,IAAKf,I,oBClGzB,SAASgB,IACtB,OACE,cAAC,IAAD,CAAQC,SAAUC,aAAlB,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,IAAIC,OAAK,EAArB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,mBAE9B,cAAC,IAAD,CAAOH,KAAK,iBAAZ,SACE,cAACxD,EAAD,W,MCZV4D,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAACT,EAAD,MAEFvB,SAASiC,eAAe,W","file":"static/js/main.79a77a51.chunk.js","sourcesContent":["import React from 'react'\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport Quill from 'quill'\r\nimport \"quill/dist/quill.snow.css\"\r\nimport { io } from \"socket.io-client\"\r\nimport { useParams } from 'react-router-dom';\r\nexport default function TextEditor() {\r\n    const { id: documentId } = useParams();\r\n    const [socket, setSocket] = useState();\r\n    const [quill, setQuill] = useState();\r\n    const SAVE_INTERVAL_MS = 2000;\r\n    const TOOLBAR_OPTIONS = [\r\n        [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n        [{ font: [] }],\r\n        [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n        [\"bold\", \"italic\", \"underline\"],\r\n        [{ color: [] }, { background: [] }],\r\n        [{ script: \"sub\" }, { script: \"super\" }],\r\n        [{ align: [] }],\r\n        [\"image\", \"blockquote\", \"code-block\"],\r\n        [\"clean\"],\r\n    ]\r\n    useEffect(() => {\r\n        const s = io('http://localhost:3001');\r\n        setSocket(s);\r\n        return () => {\r\n            s.disconnect()\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n\r\n        if (socket == null || quill == null) return;\r\n\r\n        const textChangeHandler = (delta, oldDelta, source) => {\r\n            if (source !== 'user') return;\r\n            socket.emit(\"send-changes\", delta);\r\n        }\r\n\r\n        quill.on('text-change', textChangeHandler);\r\n\r\n        return () => {\r\n            quill.off('text-change', textChangeHandler);\r\n        }\r\n    }, [socket, quill]);\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        if (socket == null || quill == null) return;\r\n\r\n        const textChangeHandler = (delta) => {\r\n            quill.updateContents(delta);\r\n        }\r\n\r\n        socket.on('receive-changes', textChangeHandler);\r\n\r\n        return () => {\r\n            socket.off('receive-changes', textChangeHandler);\r\n        }\r\n    }, [socket, quill]);\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n\r\n        socket.once('load-document', document => {\r\n            quill.setContents(document);\r\n            quill.enable();\r\n        });\r\n\r\n        socket.emit('get-document', documentId)\r\n    }, [socket, quill, documentId]);\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n\r\n        const interval = setInterval(() => {\r\n            socket.emit('save-document', quill.getContents());\r\n        }, SAVE_INTERVAL_MS);\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n        }\r\n\r\n    }, [socket, quill, documentId]);\r\n\r\n\r\n\r\n    const wrapperRef = useCallback(\r\n        (wrapper) => {\r\n            if (wrapper == null) return;\r\n            wrapper.innerHTML = \"\";\r\n            const editor = document.createElement(\"div\");\r\n            wrapper.append(editor);\r\n            const q = new Quill(editor, {\r\n                theme: \"snow\",\r\n                modules: {\r\n                    toolbar: TOOLBAR_OPTIONS\r\n                }\r\n            });\r\n            q.disable();\r\n            q.setText(\"Loading...\");\r\n            setQuill(q);\r\n        },\r\n        [])\r\n\r\n    return (\r\n        <div className=\"container\" ref={wrapperRef}></div>\r\n    );\r\n}\r\n","import TextEditor from \"./components/TextEditor\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect\n} from 'react-router-dom';\nimport { v4 as uuidV4 } from 'uuid';\n\nexport default function App() {\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n      <Switch>\n        <Route path=\"/\" exact>\n          <Redirect to={`/documents/${uuidV4()}`} />\n        </Route>\n        <Route path=\"/documents/:id\">\n          <TextEditor></TextEditor>\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './style.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}